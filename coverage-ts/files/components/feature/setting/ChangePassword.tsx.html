
  <!DOCTYPE html>
  <html>
    <head>
      <title>ChangePassword.tsx</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="..\..\..\..\assets\source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="..\..\..\..\assets\source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="..\..\..\..\index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="negative"><td class="">components\feature\setting\ChangePassword.tsx</td><td class="">92.35%</td><td class="">99%</td><td class="">170</td><td class="">157</td><td class="">13</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import useAxios from &#x27;axios-hooks&#x27;;
import Api from &#x27;../../../apis&#x27;;
import { useRef } from &#x27;react&#x27;;
import useAlert from &#x27;../../../hooks/useAlert&#x27;;
import ErrorList from &#x27;../../common/Widget/ErrorList&#x27;;
import { useFormik } from &#x27;formik&#x27;;
import { object, string } from &#x27;yup&#x27;;

const apiSetting = new Api();

function ChangePassword() {
    const [{ data: putData, loading: putLoading, error: putError }, putPassword] = useAxios(
        apiSetting.User.updateMePassword(),
        { manual: true }
    );

    const formRef = useRef&lt;HTMLFormElement&gt;(null);

    const changePasswordFormik = useFormik({
        initialValues: {
            current_password: &#x27;&#x27;,
            password: &#x27;&#x27;,
            password_confirmation: &#x27;&#x27;
        },
        onSubmit: (data) =&gt; {
            putPassword({ data }).then((res) =&gt; {
                if (res.data?.success) {
                    // request success
                    setAlert({ title: &#x27;更改成功&#x27;, type: &#x27;success&#x27; });
                }
            });
        },
        validate: ({ password, password_confirmation, current_password }) =&gt; {
            const errors: any = {};
            if (password_confirmation !== password) {
                errors.password_confirmation = &#x27;與新密碼不同&#x27;;
            }
            return errors;
        },
        validationSchema: object().shape({
            current_password: string().required(&#x27;必須填寫&#x27;),
            password: string().required(&#x27;必須填寫&#x27;),
            password_confirmation: string().required(&#x27;必須填寫&#x27;)
        }),
        validateOnChange: false
    });

    const { setAlert } = useAlert();

    return (
        &lt;div className=&quot;flex flex-col rounded-2xl bg-gray-100 px-12 py-6 border&quot;&gt;
            &lt;div className=&quot;flex flex-col&quot;&gt;
                &lt;h2 className=&quot;text-slate-900 font-bold text-xl ml-6 mb-6&quot;&gt;更改密碼&lt;/h2&gt;
                &lt;form ref={formRef} onSubmit={changePasswordFormik.handleSubmit}&gt;
                    &lt;div className=&quot;col-span-2 rounded-t-lg bg-white p-6 shadow flex flex-col gap-4&quot;&gt;
                        {!putData?.success &amp;&amp; putData?.errors &amp;&amp; (
                            &lt;ErrorList errors={putData.errors} /&gt;
                        )}
                        &lt;label className=&quot;flex flex-col gap-2&quot;&gt;
                            &lt;div&gt;原密碼&lt;/div&gt;
                            &lt;input
                                onChange={changePasswordFormik.handleChange}
                                value={changePasswordFormik.values.current_password}
                                type=&quot;password&quot;
                                name=&quot;current_password&quot;
                                className=&quot;appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm&quot;
                            /&gt;
                            &lt;div className=&quot;text-xs text-red-500&quot;&gt;
                                {changePasswordFormik.errors.current_password}
                            &lt;/div&gt;
                        &lt;/label&gt;
                        &lt;label className=&quot;flex flex-col gap-2&quot;&gt;
                            &lt;div&gt;新密碼&lt;/div&gt;
                            &lt;input
                                onChange={changePasswordFormik.handleChange}
                                value={changePasswordFormik.values.password}
                                type=&quot;password&quot;
                                name=&quot;password&quot;
                                className=&quot;appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm&quot;
                            /&gt;
                            &lt;div className=&quot;text-xs text-red-500&quot;&gt;
                                {changePasswordFormik.errors.password}
                            &lt;/div&gt;
                        &lt;/label&gt;
                        &lt;label className=&quot;flex flex-col gap-2&quot;&gt;
                            &lt;div&gt;確認新密碼&lt;/div&gt;
                            &lt;input
                                onChange={changePasswordFormik.handleChange}
                                value={changePasswordFormik.values.password_confirmation}
                                type=&quot;password&quot;
                                name=&quot;password_confirmation&quot;
                                className=&quot;appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm&quot;
                            /&gt;
                            &lt;div className=&quot;text-xs text-red-500&quot;&gt;
                                {changePasswordFormik.errors.password_confirmation}
                            &lt;/div&gt;
                        &lt;/label&gt;
                    &lt;/div&gt;
                    &lt;div className=&quot;bg-gray-50 rounded-b-lg px-6 py-3 flex justify-end shadow-md&quot;&gt;
                        &lt;button
                            className=&quot;text-white bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-lg&quot;
                            type=&quot;submit&quot;
                        &gt;
                            變更密碼
                        &lt;/button&gt;
                    &lt;/div&gt;
                &lt;/form&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    );
}

export default ChangePassword;
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:11,&quot;character&quot;:19,&quot;text&quot;:&quot;putData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:26,&quot;character&quot;:24,&quot;text&quot;:&quot;data&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:26,&quot;character&quot;:30,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:33,&quot;character&quot;:18,&quot;text&quot;:&quot;errors&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:35,&quot;character&quot;:16,&quot;text&quot;:&quot;errors&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:35,&quot;character&quot;:23,&quot;text&quot;:&quot;password_confirmation&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:55,&quot;character&quot;:26,&quot;text&quot;:&quot;putData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:55,&quot;character&quot;:35,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:55,&quot;character&quot;:46,&quot;text&quot;:&quot;putData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:55,&quot;character&quot;:55,&quot;text&quot;:&quot;errors&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:56,&quot;character&quot;:39,&quot;text&quot;:&quot;errors&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:56,&quot;character&quot;:47,&quot;text&quot;:&quot;putData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;components\\feature\\setting\\ChangePassword.tsx&quot;,&quot;line&quot;:56,&quot;character&quot;:55,&quot;text&quot;:&quot;errors&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 03 Aug 2023 09:19:42 GMT</p>
    </body>
  </html>
  