
  <!DOCTYPE html>
  <html>
    <head>
      <title>ProjectContainer.tsx</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="negative"><td class="">pages/project/ProjectContainer.tsx</td><td class="">73.40%</td><td class="">90%</td><td class="">282</td><td class="">207</td><td class="">75</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import axios from &#x27;axios&#x27;;
import useAxios from &#x27;axios-hooks&#x27;;
import _ from &#x27;lodash&#x27;;
import { useRouter } from &#x27;next/router&#x27;;
import { useCallback, useEffect, useRef, useState } from &#x27;react&#x27;;
import Api from &#x27;../../apis&#x27;;
import useAlert from &#x27;../../hooks/useAlert&#x27;;
import ProjectView from &#x27;./ProjectView&#x27;;

const apiSetting = new Api();

export default function ProjectContainer() {
    const router = useRouter();
    const { setAlert } = useAlert();
    const queryId = useRef(router.query.id);
    const queryName = useRef(router.query.name);
    const [id, setId] = useState&lt;string | null&gt;(null);
    const [name, setName] = useState&lt;string | null&gt;(null);
    const [projects, setProjects] = useState();
    const [meta, setMeta] = useState();
    const [page, setPage] = useState(1);
    const [currentStatus, setCurrentStatus] = useState(&#x27;&#x27;);
    const [
        { data: showAllItemsData, loading: showAllItemsLoading, error: showAllItemsError },
        showAllItems
    ] = useAxios({}, { manual: true });

    const [
        { data: showAllProjectsData, loading: showAllProjectsLoading, error: showAllProjectsError },
        showAllProjects
    ] = useAxios(apiSetting.Project.getAllProjects(page), { manual: false });

    const [
        { data: addNewProjectData, loading: addNewProjectLoading, error: addNewProjectError },
        addNewProject
    ] = useAxios(apiSetting.Project.addNewProject(), { manual: true });

    const [
        { data: updateProjectData, loading: updateProjectLoading, error: updateProjectError },
        updateProject
    ] = useAxios(apiSetting.Project.updateProjectById(&#x27;&#x27;), { manual: true });

    const addNewProjectHeadler = useCallback(
        async (data) =&gt; {
            const { name, description, deadline_at, parent_id } = data;
            // console.log(parent_id);
            addNewProject({
                data: {
                    name: name,
                    description: description,
                    deadline_at: deadline_at,
                    parent_id: parent_id
                }
            });
        },
        [addNewProject]
    );

    const updateProjectHandler = useCallback(
        async (data) =&gt; {
            const { id, name, description, deadline_at, folder_id, parent_id } = data;
            // console.log(&quot;parent_id&quot;, parent_id);
            updateProject({
                ...apiSetting.Project.updateProjectById(id),
                data: {
                    name: name,
                    description: description,
                    deadline_at: deadline_at
                }
            });
            if (folder_id &amp;&amp; parent_id)
                axios.request(apiSetting.Folders.updateFolderById(folder_id, parent_id));
        },
        [updateProject]
    );

    useEffect(() =&gt; {
        if (router.asPath !== router.route) {
            queryId.current = router.query.id;
            queryName.current = router.query.name;
            if (queryId.current) {
                showAllItems(apiSetting.Drive.showAllFolderItems(queryId.current.toString()));
            } else {
                showAllItems(apiSetting.Drive.showAllRootItems());
            }
        } else {
            showAllItems(apiSetting.Drive.showAllRootItems());
        }
    }, [router, showAllItems]);

    useEffect(() =&gt; {
        if (!showAllItemsLoading &amp;&amp; showAllItemsData) {
            setId(queryId.current?.toString() || null);
            setName(queryName.current?.toString() || null);
        }
    }, [showAllItemsLoading, showAllItemsData]);

    useEffect(() =&gt; {
        if (!showAllProjectsLoading &amp;&amp; showAllProjectsData) {
            showAllProjectsData.projects.map((project: any) =&gt; {
                const count = _.filter(project.project_tasks, function (p) {
                    return p[&#x27;is_completed&#x27;] === true;
                }).length;
                project.progress = Math.round(
                    (count / (project.project_tasks.length || 1).toFixed(0)) * 100
                );
                return project;
            });
            setProjects(showAllProjectsData.projects);
            setMeta(showAllProjectsData?.meta);
        }
    }, [showAllProjectsLoading, showAllProjectsData]);

    useEffect(() =&gt; {
        if (addNewProjectData &amp;&amp; addNewProjectData.success) {
            router.reload();
        }
    }, [addNewProjectData]);

    useEffect(() =&gt; {
        if (updateProjectData &amp;&amp; updateProjectData.success) {
            router.reload();
        } else if (updateProjectData &amp;&amp; !updateProjectData.success) {
            setAlert({ title: updateProjectData.error, type: &#x27;error&#x27; });
        }
    }, [updateProjectData]);

    useEffect(() =&gt; {
        if (currentStatus &amp;&amp; projects) {
            const data: any = _.filter(showAllProjectsData?.projects, function (o: any) {
                if (currentStatus == &#x27;all&#x27;) return o;
                else if (currentStatus == &#x27;finish&#x27;) return o[&#x27;progress&#x27;] == 100;
                else if (currentStatus == &#x27;unfinish&#x27;) return o[&#x27;progress&#x27;] != 100;
            });
            setProjects(data);
        }
    }, [currentStatus]);

    useEffect(() =&gt; {
        if (router.query.page) {
            setPage(parseInt(router.query.page + &#x27;&#x27;) || 1);
        }
    }, [router.query.page]);

    return (
        &lt;ProjectView
            {...{
                id,
                name,
                showAllItemsData,
                projects,
                meta,
                currentStatus,
                setCurrentStatus,
                addNewProjectHeadler,
                updateProjectHandler
            }}
        /&gt;
    );
}
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:23,&quot;character&quot;:16,&quot;text&quot;:&quot;showAllItemsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:28,&quot;character&quot;:16,&quot;text&quot;:&quot;showAllProjectsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:33,&quot;character&quot;:16,&quot;text&quot;:&quot;addNewProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:38,&quot;character&quot;:16,&quot;text&quot;:&quot;updateProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:43,&quot;character&quot;:15,&quot;text&quot;:&quot;data&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:44,&quot;character&quot;:20,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:44,&quot;character&quot;:26,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:44,&quot;character&quot;:39,&quot;text&quot;:&quot;deadline_at&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:44,&quot;character&quot;:52,&quot;text&quot;:&quot;parent_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:48,&quot;character&quot;:20,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:48,&quot;character&quot;:26,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:49,&quot;character&quot;:20,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:49,&quot;character&quot;:33,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:50,&quot;character&quot;:20,&quot;text&quot;:&quot;deadline_at&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:50,&quot;character&quot;:33,&quot;text&quot;:&quot;deadline_at&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:51,&quot;character&quot;:20,&quot;text&quot;:&quot;parent_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:51,&quot;character&quot;:31,&quot;text&quot;:&quot;parent_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:59,&quot;character&quot;:15,&quot;text&quot;:&quot;data&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:60,&quot;character&quot;:20,&quot;text&quot;:&quot;id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:60,&quot;character&quot;:24,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:60,&quot;character&quot;:30,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:60,&quot;character&quot;:43,&quot;text&quot;:&quot;deadline_at&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:60,&quot;character&quot;:56,&quot;text&quot;:&quot;folder_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:60,&quot;character&quot;:67,&quot;text&quot;:&quot;parent_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:65,&quot;character&quot;:20,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:65,&quot;character&quot;:26,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:66,&quot;character&quot;:20,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:66,&quot;character&quot;:33,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:67,&quot;character&quot;:20,&quot;text&quot;:&quot;deadline_at&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:67,&quot;character&quot;:33,&quot;text&quot;:&quot;deadline_at&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:70,&quot;character&quot;:16,&quot;text&quot;:&quot;folder_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:70,&quot;character&quot;:29,&quot;text&quot;:&quot;parent_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:91,&quot;character&quot;:36,&quot;text&quot;:&quot;showAllItemsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:95,&quot;character&quot;:29,&quot;text&quot;:&quot;showAllItemsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:98,&quot;character&quot;:39,&quot;text&quot;:&quot;showAllProjectsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:99,&quot;character&quot;:12,&quot;text&quot;:&quot;showAllProjectsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:99,&quot;character&quot;:32,&quot;text&quot;:&quot;projects&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:99,&quot;character&quot;:41,&quot;text&quot;:&quot;map&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:99,&quot;character&quot;:46,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:100,&quot;character&quot;:39,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:100,&quot;character&quot;:47,&quot;text&quot;:&quot;project_tasks&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:100,&quot;character&quot;:72,&quot;text&quot;:&quot;p&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:101,&quot;character&quot;:27,&quot;text&quot;:&quot;p&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:103,&quot;character&quot;:16,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:103,&quot;character&quot;:24,&quot;text&quot;:&quot;progress&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:104,&quot;character&quot;:30,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:104,&quot;character&quot;:38,&quot;text&quot;:&quot;project_tasks&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:104,&quot;character&quot;:52,&quot;text&quot;:&quot;length&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:104,&quot;character&quot;:65,&quot;text&quot;:&quot;toFixed&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:106,&quot;character&quot;:23,&quot;text&quot;:&quot;project&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:108,&quot;character&quot;:24,&quot;text&quot;:&quot;showAllProjectsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:108,&quot;character&quot;:44,&quot;text&quot;:&quot;projects&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:109,&quot;character&quot;:20,&quot;text&quot;:&quot;showAllProjectsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:109,&quot;character&quot;:41,&quot;text&quot;:&quot;meta&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:111,&quot;character&quot;:32,&quot;text&quot;:&quot;showAllProjectsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:114,&quot;character&quot;:12,&quot;text&quot;:&quot;addNewProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:114,&quot;character&quot;:33,&quot;text&quot;:&quot;addNewProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:114,&quot;character&quot;:51,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:117,&quot;character&quot;:8,&quot;text&quot;:&quot;addNewProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:120,&quot;character&quot;:12,&quot;text&quot;:&quot;updateProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:120,&quot;character&quot;:33,&quot;text&quot;:&quot;updateProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:120,&quot;character&quot;:51,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:122,&quot;character&quot;:19,&quot;text&quot;:&quot;updateProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:122,&quot;character&quot;:41,&quot;text&quot;:&quot;updateProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:122,&quot;character&quot;:59,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:123,&quot;character&quot;:30,&quot;text&quot;:&quot;updateProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:123,&quot;character&quot;:48,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:125,&quot;character&quot;:8,&quot;text&quot;:&quot;updateProjectData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:129,&quot;character&quot;:18,&quot;text&quot;:&quot;data&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:129,&quot;character&quot;:39,&quot;text&quot;:&quot;showAllProjectsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:129,&quot;character&quot;:60,&quot;text&quot;:&quot;projects&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:129,&quot;character&quot;:80,&quot;text&quot;:&quot;o&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:131,&quot;character&quot;:59,&quot;text&quot;:&quot;o&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:132,&quot;character&quot;:61,&quot;text&quot;:&quot;o&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages/project/ProjectContainer.tsx&quot;,&quot;line&quot;:149,&quot;character&quot;:16,&quot;text&quot;:&quot;showAllItemsData&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Sun, 13 Aug 2023 09:27:06 GMT</p>
    </body>
  </html>
  