
  <!DOCTYPE html>
  <html>
    <head>
      <title>CreateContainer.tsx</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="..\..\..\..\assets\source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="..\..\..\..\assets\source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="..\..\..\..\index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="negative"><td class="">pages\miniapp\create\CreateContainer.tsx</td><td class="">72.40%</td><td class="">99%</td><td class="">192</td><td class="">139</td><td class="">53</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import useAxios from &#x27;axios-hooks&#x27;;
import { useRouter } from &#x27;next/router&#x27;;
import { useCallback, useEffect, useState } from &#x27;react&#x27;;
import Api from &#x27;../../../apis/index&#x27;;
import useAlert from &#x27;../../../hooks/useAlert&#x27;;
import CreateView from &#x27;./CreateView&#x27;;

const apiSetting = new Api();

function MiniappContainer() {
    const { setAlert } = useAlert();
    const router = useRouter();
    const [miniAppData, setMiniAppData] = useState();
    const [actionContent, setActionContent] = useState(&#x27;&#x27;);
    const [open, setOpen] = useState(false);

    const [{ data: getTagFunctionsData }, getTagFunctions] = useAxios(
        apiSetting.Tag.getTagFunctions(),
        {
            manual: false
        }
    );

    const [{ data: getAllLabelsData, error: getAllLabelsError }, getAllLabels] = useAxios(
        apiSetting.Tag.getAllTags(),
        { manual: false }
    );

    const [{ data: schemasStatusReadyData }, schemasStatusReady] = useAxios(
        apiSetting.Form.schemasStatusReady(),
        {
            manual: false
        }
    );

    const [{ data: createMiniAppsData, loading: submitting }, createMiniApps] = useAxios(
        apiSetting.MiniApp.create(),
        {
            manual: true
        }
    );

    const [{ data: updateMiniAppsData, loading: updateing }, updateMiniApps] = useAxios(
        apiSetting.MiniApp.update(router.query.id + &#x27;&#x27;),
        {
            manual: true
        }
    );

    const [{ data: showMiniAppByIdData, loading: loading }, showMiniAppById] = useAxios(
        apiSetting.MiniApp.showMiniAppById(router.query.id + &#x27;&#x27;),
        {
            manual: true
        }
    );

    const updateMiniappHandler = useCallback(
        async (data) =&gt; {
            setActionContent(&#x27;正在保存數據...&#x27;);
            setOpen(true);
            const {
                name,
                description,
                form_schema_id,
                function_name,
                tag_id,
                target_folder_id,
                needs_deep_understanding
            } = data;
            const formData = {
                name: name,
                description: description,
                folder_id: target_folder_id,
                document_label_list: [tag_id],
                app_function_list: [function_name],
                meta:
                    needs_deep_understanding &amp;&amp; form_schema_id
                        ? { form_schema_id: form_schema_id }
                        : {}
            };
            if (router.query.id) {
                updateMiniApps({
                    data: formData
                });
            } else {
                createMiniApps({
                    data: formData
                });
            }
        },
        [router, createMiniApps, updateMiniApps]
    );

    useEffect(() =&gt; {
        if (router.query.id) {
            setOpen(true);
            setActionContent(&#x27;正在加载數據...&#x27;);
            showMiniAppById();
        }
    }, [router]);

    useEffect(() =&gt; {
        if (showMiniAppByIdData &amp;&amp; showMiniAppByIdData.success) {
            setOpen(false);
            setMiniAppData(showMiniAppByIdData?.mini_app);
        }
    }, [showMiniAppByIdData]);

    useEffect(() =&gt; {
        if (createMiniAppsData &amp;&amp; createMiniAppsData.success) {
            // console.log(createMiniAppsData);
            setAlert({ title: &#x27;新增成功!&#x27;, type: &#x27;success&#x27; });
            setOpen(false);
            router.reload();
        } else if (createMiniAppsData &amp;&amp; !createMiniAppsData.success) {
            setOpen(false);
            setAlert({ title: createMiniAppsData.error, type: &#x27;error&#x27; });
        }
    }, [createMiniAppsData]);

    useEffect(() =&gt; {
        if (updateMiniAppsData &amp;&amp; updateMiniAppsData.success) {
            setOpen(false);
            setAlert({ title: &#x27;更新成功!&#x27;, type: &#x27;success&#x27; });
        } else if (updateMiniAppsData &amp;&amp; !updateMiniAppsData.success) {
            setOpen(false);
            setAlert({ title: updateMiniAppsData.error, type: &#x27;error&#x27; });
        }
    }, [updateMiniAppsData]);

    return (
        &lt;&gt;
            &lt;CreateView
                {...{
                    getTagFunctionsData,
                    updateMiniappHandler,
                    getAllLabelsData,
                    schemasStatusReadyData,
                    open,
                    setOpen,
                    miniAppData,
                    actionContent
                }}
            /&gt;
        &lt;/&gt;
    );
}

export default MiniappContainer;
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:16,&quot;character&quot;:19,&quot;text&quot;:&quot;getTagFunctionsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:23,&quot;character&quot;:19,&quot;text&quot;:&quot;getAllLabelsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:28,&quot;character&quot;:19,&quot;text&quot;:&quot;schemasStatusReadyData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:35,&quot;character&quot;:19,&quot;text&quot;:&quot;createMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:42,&quot;character&quot;:19,&quot;text&quot;:&quot;updateMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:49,&quot;character&quot;:19,&quot;text&quot;:&quot;showMiniAppByIdData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:57,&quot;character&quot;:15,&quot;text&quot;:&quot;data&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:61,&quot;character&quot;:16,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:62,&quot;character&quot;:16,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:63,&quot;character&quot;:16,&quot;text&quot;:&quot;form_schema_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:64,&quot;character&quot;:16,&quot;text&quot;:&quot;function_name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:65,&quot;character&quot;:16,&quot;text&quot;:&quot;tag_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:66,&quot;character&quot;:16,&quot;text&quot;:&quot;target_folder_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:67,&quot;character&quot;:16,&quot;text&quot;:&quot;needs_deep_understanding&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:70,&quot;character&quot;:16,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:70,&quot;character&quot;:22,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:71,&quot;character&quot;:16,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:71,&quot;character&quot;:29,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:72,&quot;character&quot;:16,&quot;text&quot;:&quot;folder_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:72,&quot;character&quot;:27,&quot;text&quot;:&quot;target_folder_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:73,&quot;character&quot;:38,&quot;text&quot;:&quot;tag_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:74,&quot;character&quot;:36,&quot;text&quot;:&quot;function_name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:76,&quot;character&quot;:20,&quot;text&quot;:&quot;needs_deep_understanding&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:76,&quot;character&quot;:48,&quot;text&quot;:&quot;form_schema_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:77,&quot;character&quot;:28,&quot;text&quot;:&quot;form_schema_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:77,&quot;character&quot;:44,&quot;text&quot;:&quot;form_schema_id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:102,&quot;character&quot;:12,&quot;text&quot;:&quot;showMiniAppByIdData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:102,&quot;character&quot;:35,&quot;text&quot;:&quot;showMiniAppByIdData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:102,&quot;character&quot;:55,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:104,&quot;character&quot;:27,&quot;text&quot;:&quot;showMiniAppByIdData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:104,&quot;character&quot;:48,&quot;text&quot;:&quot;mini_app&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:106,&quot;character&quot;:8,&quot;text&quot;:&quot;showMiniAppByIdData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:109,&quot;character&quot;:12,&quot;text&quot;:&quot;createMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:109,&quot;character&quot;:34,&quot;text&quot;:&quot;createMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:109,&quot;character&quot;:53,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:114,&quot;character&quot;:19,&quot;text&quot;:&quot;createMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:114,&quot;character&quot;:42,&quot;text&quot;:&quot;createMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:114,&quot;character&quot;:61,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:116,&quot;character&quot;:30,&quot;text&quot;:&quot;createMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:116,&quot;character&quot;:49,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:118,&quot;character&quot;:8,&quot;text&quot;:&quot;createMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:121,&quot;character&quot;:12,&quot;text&quot;:&quot;updateMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:121,&quot;character&quot;:34,&quot;text&quot;:&quot;updateMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:121,&quot;character&quot;:53,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:124,&quot;character&quot;:19,&quot;text&quot;:&quot;updateMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:124,&quot;character&quot;:42,&quot;text&quot;:&quot;updateMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:124,&quot;character&quot;:61,&quot;text&quot;:&quot;success&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:126,&quot;character&quot;:30,&quot;text&quot;:&quot;updateMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:126,&quot;character&quot;:49,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:128,&quot;character&quot;:8,&quot;text&quot;:&quot;updateMiniAppsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:134,&quot;character&quot;:20,&quot;text&quot;:&quot;getTagFunctionsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:136,&quot;character&quot;:20,&quot;text&quot;:&quot;getAllLabelsData&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;pages\\miniapp\\create\\CreateContainer.tsx&quot;,&quot;line&quot;:137,&quot;character&quot;:20,&quot;text&quot;:&quot;schemasStatusReadyData&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 03 Aug 2023 09:19:42 GMT</p>
    </body>
  </html>
  